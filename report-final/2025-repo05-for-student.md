# 回答用紙 （学生用）

(本Markdownファイルを記入し、課題を完成、提出すること)

##  API実習　2025　課題レポート（第5回）

**API 実習課題**:　**第4回課題にて策定したAPI要件定義に基づき、API提供者としてAPI設計・実装する**

**レポート04（要件定義）**に対応した、**最終課題05：API設計と実装** の**精緻なレポート課題設定**、
**要件定義の充足度に連動した採点基準（100点）**である。

###  出題範囲：　API実習2025　第1回～第15回まで

###  提出期限：　2026/2/10(火) 12:00


## タイトル：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿

レポート提出者：

|クラス|学籍番号|　氏名　|
|-|-|-|
|B| 20124004 |  井越悠斗  |



1.  **背景・業務領域の具体化**
    *   レポート04の背景を要約し、**変更点**（あれば）を明示。理由と影響を記述
         - 様々な予約方法がある現代において、たまにダブルブッキングが起こってしまうのを解決するためのAPIを作成。ニュースで予約がかぶってしまっているというのを見て、予約はお店の売り上げに直結してくるものなのでできれば起きる可能性をゼロにしたいのと、キャンセルが入った際の情報共有時点のエラーを減らすため。また、自分もアルバイトをしているが、電話などで予約、キャンセルを受けることがあるのでダブルブッキングを起こしてしまう可能性があったり、情報共有のエラーを起こさないために作成。このAPIを作成した際の影響としては、キャンセル時の情報共有をスムーズできたり、ダブルブッキングが発生する確率をほぼゼロにし、売り上げの向上が見込める。
2.  **課題・目的・APIが必要な理由**
    *   **KPI/成功指標**を再掲（レポート04）→**今回の実測**と比較
          - API平均レスポンス時間 < 300ms、p95レスポンス　< 500ms、同時接続数：100以上
          - APIエラー率 < 0.1%、二重予約発生率：0件
          - 対応時間：30%以上削除
          - API稼働率：99.9%、外部連携成功率：99%以上

3.  **ユーザ／ステークホルダ**
    *   **権限モデル**（管理者/一般/外部アプリ）と**認可ルール**を表で提示
- ステークホルダ
| ステークホルダー | 権限レベル | 認可ルール |
|----|----------|--------------|
| 利用者 |    予約を新規作成する    |       客、スタッフ、外部システム       |   空き時間を確認、予約登録   |     予約が重複なく登録され、ステータスが確定となる     |
| 事業者 |    予約を変更する    |       客、スタッフ       |   既存の予約の情報を期限内に変更   |     変更後の内容が正しく反映され、予約情報が更新されている     |
| 運用者 |    予約をキャンセルする    |       客、スタッフ       |   既存の予約を期限内にキャンセルする   |     予約ステータスがキャンセルに更新され、履歴が保存される     |
| 外部サービス提供者 |    来店状況を更新する    |       スタッフ       |   来店済みなどのステータスを当日に更新する   |     予約ステータスが来店済みとなる     |

      

5.  **業務フロー・ユースケース**
    *   Mermaid図で**2件以上の主要ユースケース**を実装に対応づけ（ID付与）
- 業務フロー
- 予約作成
```mermaid
flowchart TD
  A[利用者 / スタッフ] -->|予約情報入力| B[Web/モバイル]
  B -->|HTTP Request| C[API Gateway]
  C -->|認証・認可| D[予約サービス]
  D -->|空き状況確認| E[(予約 DB)]
  D -->|予約重複チェック| E
  D -->|予約登録| E
  D -->|結果返却| C
  C -->|HTTP Response| B
  B -->|完了表示| A
````
- 予約変更・キャンセル
```mermaid
flowchart TD
  A[利用者 / スタッフ] --> B[Web/モバイル]
  B --> C[API Gateway]
  C --> D[予約サービス]
  D -->|変更期限チェック| E[(予約 DB)]
  D -->|予約更新 or キャンセル| E
  D --> C
  C --> B
  B --> A
````
- 外部サービス連携
```mermaid
flowchart TD
  A[外部予約サイト] -->|予約データ送信| C[API Gateway]
  C -->|APIキー認証| D[予約サービス]
  D -->|予約登録| E
  D -->|通知要求| F[通知サービス]
  D --> C
  C --> A
````

- ユースケース

| ID | タイトル | 主要アクター | 概要 | 成功条件 |
|----|----------|--------------|------|----------|
| UC-01 |    予約を新規作成する    |       客、スタッフ、外部システム       |   空き時間を確認、予約登録   |     予約が重複なく登録され、ステータスが確定となる     |
| UC-02 |    予約を変更する    |       客、スタッフ       |   既存の予約の情報を期限内に変更   |     変更後の内容が正しく反映され、予約情報が更新されている     |
| UC-03 |    予約をキャンセルする    |       客、スタッフ       |   既存の予約を期限内にキャンセルする   |     予約ステータスがキャンセルに更新され、履歴が保存される     |
| UC-04 |    来店状況を更新する    |       スタッフ       |   来店済みなどのステータスを当日に更新する   |     予約ステータスが来店済みとなる     |
| UC-05 |    店舗情報を管理する    |       管理者       |   営業時間、定休日、予約ルールを設定、変更する   |     設定内容が保存され以降の予約に反映される     |

6.  **関連技術・先行事例**
    *   採用技術を**実装バージョン**付きで列挙（例：言語、FW、DB）

7.  **技術比較／選定理由**
    *   候補の利点/欠点/トレードオフ＋**採用理由**（ユースケース適合性）

8.  **機能要件（エンドポイントの明確さ・一貫性）**
    *   OpenAPIへ**双方向リンク**（エンドポイント→要件ID）
    *   **ステータスコード/エラー形式**の規約を明記

9.  **非機能要件（測定可能な指標・現実性）**
    *   **性能（スループット、同時接続）**の**目標値**
    *   **セキュリティ**（認証/認可/暗号化/脆弱性対策/監査ログ）
    *   **可用性**（SLA目標、冗長化構成/障害対応手順）
    *   **拡張性**（スケール戦略）／**保守性**（テスト/デプロイ/ドキュメント運用）

10.  **まとめ**


## 最終課題05：チェックリスト

*   [ ] **OpenAPI**（例・エラー・バージョン・セキュリティスキーム）
*   [ ] **ユースケース2件以上**を**実装で再現**（成功/失敗/例外パターン）
*   [ ] **性能指標**（スループット・エラー率）**測定**と**目標比較**
*   [ ] **認証/認可**と**レート制限**の動作確認
*   [ ] **監視/ログ/監査**の方針と実装の証跡
*   [ ] **運用要件**（バックアップ/復旧、秘密情報管理）を明記
*   [ ] **テスト**（契約/ユニット/認可/例外）
*   [ ] **参考文献**の明記（標準仕様/事例）

***

## READMEテンプレート

```markdown
# 最終課題05：自作API（v1）
## 目的
レポート04で定義した業務課題をAPIで解決し、動作確認、検証し説明分析する。

## 要件→設計→実装→検証（トレーサビリティ）
| 要件ID | ユースケース | OpenAPIパス | 実装（src/...） | テスト（tests/...） | KPI目標 | KPI実測 |
|--------|--------------|-------------|-----------------|---------------------|---------|---------|
| RQ-01  | UC-01        | /v1/items   | items.py        | test_items.py::...  | p95<200ms| 178ms   |

## 環境/起動
- Docker: `docker compose up -d`
- ローカル: `python -m venv .venv && ...`

## 検証手順
- 契約テスト: `pytest -m contract`
- デモ: `scripts/demo.sh`（curl）または Postman

## 参考
- openapi.yaml / figs/architecture.png









