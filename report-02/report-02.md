
##  API実習　2025　課題レポート（第2回）修正版

  
###  出題範囲：　API実習2025　第4回～第6回まで

###  提出期限：　2025/12/15(月) 17:00

## 出題範囲
- **API実習(4)**：レスポンスデータ設計、JSON/JSONP、フォーマット指定、セキュリティ（XSS, CSRF）、Same-Origin Policy、CORS
- **API実習(5)**：レスポンス項目命名規則、エラー設計、HTTPステータスコード、日付フォーマット、識別子設計
- **API実習(6)**：HTTP仕様、キャッシュ制御、メディアタイプ、コンテンツネゴシエーション、ステータスコード詳細


## 提出形式
- 各問に対して **400～600字程度の解答**を記述
- 図や表を用いる場合はMarkdown記法で挿入



## 課題一覧

### 問1：HTTPステータスコードの分類と役割
HTTPステータスコードは100番台から500番台まで分類されています。それぞれのカテゴリ（情報、成功、リダイレクト、クライアントエラー、サーバエラー）について、**代表的なコードと意味を3つずつ挙げ、API設計でどのような場面で使うか具体例を示してください**。

100:クライアントが送ったリクエストの初期部分を受け取り、送信してよい合図
101:サーバーが別のプロトコルへ切り替える
102:リクエストを処理中だが、結果が出ていない
200:リクエストは成功
201:リクエストは成功し、新しいソースが生成
202:リクエストは成功・受理
300:複数のリソースが存在する
301:リソースが恒久的に移動した
302:リクエストしたリソースのURLが一時的に変更
400:リクエストが正しくない
401:認証が必要
403:アクセスが禁止されている
500:サーバー側でエラーが発生
502:上流サーバーから不正な応答を受け取った
503:サ－バーが一時的に利用不可
100番台はプロトコルの切り替えや巨大なデータの送信時の合図として使われる。200番台は通常の成功レスポンス（作成・取得・削除）。300番台はAPIのURL移転やCDNへのリダイレクト、キャッシュ制御。400番台はバリデーション、認識・認可、レート制限、存在しないリソースの報告。500番台はサーバー内部エラー、障害、外部サービスの問題の報告。に使われる。

---

### 問2：JSONとXMLの比較
WebAPIのレスポンス形式としてJSONが主流になった理由を、**XMLとの比較で3つ以上挙げて説明してください**。また、**JSONPの仕組みと利用目的、セキュリティ上の問題点を簡潔にまとめてください**。

WebAPIのレスポンス形式としてJSONが主流になった理由としては、まずXMLと比べて データサイズが小さく通信が高速である点が挙げられる。XMLはタグが多く冗長になりやすいのに対し、JSON はシンプルな構造のため軽量で扱いやすい。またJSONは JavaScriptと記法が共通しているため ブラウザやフロントエンドとの親和性が高く、パース速度も速い。多くの言語で標準的にサポートされていることや、可読性が高いことも利点である。さらに、軽量で状態を持たない通信を重視するREST APIの設計思想と相性が良いことから、WebAPI では XML より JSON が一般的に採用されるようになった。次にJSONPとは、APIがJSONの代わりに JavaScript の関数呼び出し形式でデータを返す仕組みであり、同一生成元ポリシーを回避して他ドメインのAPI アクセスするために利用されていた。CORS が普及する以前は、別ドメインからデータを取得する手段として広く用いられていたが、JSONPには 任意のスクリプトが実行される危険性があり、改ざんされたAPIから悪意あるコードを読み込んでしまうと即実行されるという重大なリスクがある。また、GETメソッドしか利用できず、リクエスト内容が盗み見られる可能性もある。このような理由から、現在ではより安全なCORSが主流となり、JSONPは推奨されていない。

---

### 問3（実演）：PostmanでSheetDB APIにGETリクエスト
- 無償で利用できるSheetDBの公開エンドポイントを使い、Postmanで`GET`リクエストを送信してください。
- **操作手順**：
  1. Postmanを起動し、新規リクエストを作成
  2. メソッドを`GET`に設定
  3. URLに以下を入力：`https://sheetdb.io/api/v1/58f61be4dda40`
  4. Sendをクリック
- **報告内容**：
  - ステータスコード
  - レスポンスヘッダ（`Content-Type`など）
  - レスポンスJSONのスクリーンショット
<img width="1170" height="547" alt="スクリーンショット 2025-12-09 113534" src="https://github.com/user-attachments/assets/2847c864-7747-4fbb-8dc2-2a9a45a7603a" />
<img width="1244" height="837" alt="スクリーンショット 2025-12-09 113555" src="https://github.com/user-attachments/assets/e8694939-4980-4e34-a56f-05749d2f248d" />
<img width="1160" height="866" alt="スクリーンショット 2025-12-09 113807" src="https://github.com/user-attachments/assets/6f19f2d0-1af7-4bf7-b7a3-b9bfecfc1eae" />

---

### 問4：キャッシュ制御の仕組み
HTTPキャッシュの2つのモデル（Expiration ModelとValidation Model）について、**仕組みと利用シーンを説明してください**。また、以下のヘッダの意味を答えてください。
```

HTTP キャッシュには「Expiration Model」と「Validation Model」の2つの方式がある。まずExpiration Model（有効期限モデル）は、サーバーがレスポンスに「このデータは一定時間キャッシュしてよい」という有効期限を示す方式である。Cache-Control: max-age=3600やExpiresヘッダが代表的で、クライアントは期限内であればサーバーへ問い合わせずローカルキャッシュをそのまま利用する。更新がほとんどない画像、CSS、JavaScript などの静的ファイルに適しており、サーバー負荷の軽減やレスポンスの高速化に大きく貢献する。
一方でValidation Model（検証モデル）は、キャッシュが最新かどうかをサーバーに問い合わせて確認する仕組みである。サーバーはリソースにETagやLast-Modifiedを付与し、クライアントは次回アクセス時にIf-None-MatchやIf-Modified-Sinceを送って変更の有無を確認する。更新がなければサーバーは304 Not Modifiedを返し、クライアントは既存のキャッシュを継続利用する。商品情報やニュース一覧など、変更される可能性はあるが毎回取得する必要がない動的データに向いている。
このように、Expiration Modelは更新頻度が低い静的データの高速配信に、Validation Modelは更新可能性のあるデータの効率的な取得に適しており、場面に応じて使い分けられている。

Cache-Control: max-age=3600
・取得して「3600秒（1時間）」の間はキャッシュしてよい。有効期限内であれば、クライアントはサーバー再アクセスせず、ローカルキャッシュをそのまま利用できる。
Expires: Tue, 14 Dec 2021 00:00:00 JST
・指定された時間までをキャッシュしてよいという有効期限を絶対自国で示すヘッダ。Cache-Controlがない場合に利用されるが、同時に指定されている場合はCache-Controlが優先される
ETag: "abc123"
・このリソースのバージョン識別子・タグ。クライアントは次回アクセスしたときにIf-None-Match: "abc123"を送りリソースが変更されたか確認する。変更がなければサーバーは304 Not Modifiedを返し、キャッシュを継続利用させる。
```

---

### 問5（実演）：レスポンスJSONの分析
- 問3で取得したレスポンスJSONを分析し、**キーの命名規則（キャメルケース、スネークケースなど）と構造の特徴をまとめてください**。
- **報告内容**：
  - 実際のレスポンス例
  - 命名規則の評価
  - 改善提案

---

### 問6：エラー設計と詳細情報
APIでエラーが発生した場合、HTTPステータスコードだけでなく詳細情報を返すことが推奨されます。**以下の観点でエラー情報設計のポイントをまとめてください**。
- 開発者向けメッセージと利用者向けメッセージの違い
- エラー原因の分類（例：認証、権限、リソース不在）
- ドキュメントURLの付与の意義

---

### 問7：日付フォーマットと国際化
APIレスポンスで日付を扱う場合、RFC 3339（ISO8601）形式が推奨されます。**以下の3つのフォーマットの違いを説明し、どの形式を採用すべきか理由を述べてください**。
- `Sun, 05 Dec 2021 07:57:37 GMT`（RFC 1123）
- `2021-12-05T12:34:56+09:00`（RFC 3339）
- `Sun Dec 5 12:34:56 2021`（asctime形式）

---

### 問8（実演）：Acceptヘッダの実験
- Postmanで`Accept`ヘッダを`application/json`と`text/html`に変えてSheetDB APIにリクエストし、レスポンスの違いを確認してください。
- **報告内容**：
  - それぞれのレスポンスのスクリーンショット
  - 違いの説明

---

### 問9：セキュリティ対策（XSS・CSRF）
WebAPI利用時に発生しうるXSSとCSRF攻撃について、**攻撃の仕組みと被害例を説明し、それぞれの対策を3つずつ挙げてください**。また、**Same-Origin PolicyとCORSの関係を簡潔にまとめてください**。

---

### 問10：コンテンツネゴシエーション
HTTPのコンテンツネゴシエーションにおいて、**Acceptヘッダとq値（品質値）の役割を説明し、以下の例でサーバがどのメディアタイプを選択するか理由を述べてください**。
```
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
```
